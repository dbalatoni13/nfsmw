#define BOOTGAME_ADDR "lbl_80003244"

__attribute__((section(".init"), naked, noreturn)) void __start(void) {
    __asm__ volatile (
        "lis 1, _stack_addr@h\n"
        "ori 1, 1, _stack_addr@l\n"
        "lis 2, _SDA2_BASE_@h\n"
        "ori 2, 2, _SDA2_BASE_@l\n"
        "lis 13, _SDA_BASE_@h\n"
        "ori 13, 13, _SDA_BASE_@l\n"
        "bl fn_80003300\n"
        "bl fn_80003334\n"
        "bl __init_hardware\n"
        "li 0, -0x1\n"
        "stwu 1, -0x8(1)\n"
        "stw 0, 0x4(1)\n"
        "stw 0, 0x0(1)\n"
        "lis 3, value.10688@h\n"
        "ori 3, 3, value.10688@l\n"
        "li 4, 0x0\n"
        "lis 5, 0x804f\n"
        "ori 5, 5, 0xedac\n"
        "subf 5, 3, 5\n"
        "bl memset\n"
        "lis 3, lbl_804FF8C0@h\n"
        "ori 3, 3, lbl_804FF8C0@l\n"
        "li 4, 0x0\n"
        "lis 5, 0x804f\n"
        "ori 5, 5, 0xff38\n"
        "subf 5, 3, 5\n"
        "bl memset\n"
        "li 4, 0x0\n"
        "lis 5, 0x8000\n"
        "stw 4, 0x44(5)\n"
        "li 29, 0x0\n"
        "lis 6, 0x8000\n"
        "ori 6, 6, 0xf4\n"
        "lwz 6, 0x0(6)\n"
        "cmpwi 6, 0x0\n"
        "beq .L_800031A4\n"
        "lwz 3, 0xc(6)\n"
        "cmplwi 3, 0x2\n"
        "blt .L_800031A4\n"
        "bl fn_8030EC5C\n"
        "li 29, 0x1\n"
        ".L_800031A4:\n"
        "bl fn_80003254\n"
        "mr 30, 3\n"
        "mr 31, 4\n"
        "bl DBInit\n"
        "bl OSInit\n"
        "lis 4, 0x8000\n"
        "lhz 3, 0x30e6(4)\n"
        "andi. 4, 3, 0x8000\n"
        "beq .L_800031D4\n"
        "andi. 3, 3, 0x7fff\n"
        "cmplwi 3, 0x1\n"
        "bne .L_800031D8\n"
        ".L_800031D4:\n"
        "bl fn_800032C0\n"
        ".L_800031D8:\n"
        "bl fn_80003464\n"
        "mr 3, 30\n"
        "mr 4, 31\n"
        "bl fn_80003464\n"
        "bl __init_user\n"
        "cmpwi 29, 0x0\n"
        "beq " BOOTGAME_ADDR "\n"
        "lis 3, lbl_804394B0@h\n"
        "ori 3, 3, lbl_804394B0@l\n"
        "lis 4, __SN_Libsn_version@h\n"
        "ori 4, 4, __SN_Libsn_version@l\n"
        "lwz 4, 0x0(4)\n"
        "bl OSReport\n"
        "lis 3, lbl_80439490@h\n"
        "ori 3, 3, lbl_80439490@l\n"
        "bl OSReport\n"
        "mfmsr 5\n"
        "ori 4, 5, 0x8000\n"
        "xori 4, 4, 0x8000\n"
        "mtmsr 4\n"
        "sync\n"
        "ori 5, 5, 0x200\n"
        "mtsrr1 5\n"
        "lis 4, " BOOTGAME_ADDR "@h\n"
        "ori 4, 4, " BOOTGAME_ADDR "@l\n"
        "mtsrr0 4\n"
        "rfi\n"
    );
}

__attribute__((section(".init"))) __attribute__((noreturn)) void lbl_80003244(void) {
    __asm__(
        "mr 3, 30\n"
        "mr 4, 31\n"
        "bl main\n"
        "b exit\n"
    );
}
